<!DOCTYPE html>
<html>

<head>
  <title>Facebook Login Demo</title>
  <meta charset="utf-8">
</head>

<body>
    <!-- Step 1 -->
    <fb:login-button scope="public_profile,email" onlogin="checkLoginState();"></fb:login-button>
    <div id="status"></div>
    <button id="logout">log_out</button>
    <img id="pic">
  <script src="id.js"></script>
  <script>
    // This is called with the results from from FB.getLoginStatus().
    // FB.logout(function (response) {
    //     console.log(response+"->logout")
    //   })

    document.getElementById('logout').addEventListener('click',function(){
      FB.logout()
    })

    function statusChangeCallback(response) {

      console.log('statusChangeCallback')
      console.log(response)

      // Step 4
      if (response.status === 'connected') {
        // Logged into your app and Facebook.
        testAPI()
      } else if (response.status === 'not_authorized') {
        // The person is logged into Facebook, but not your app.
        document.getElementById('status').innerHTML = 'Please log into this app.'
      } else {
        // The person is not logged into Facebook, so we're not sure if
        // they are logged into this app or not.
        document.getElementById('status').innerHTML = 'Please log into Facebook.'
      }
    }

    // Step 3
    function checkLoginState() {

      FB.getLoginStatus(function (response) {
        statusChangeCallback(response)
      })
    }

    //Step 2
    window.fbAsyncInit = function () {
      FB.init({
        appId: myAppId,
        cookie: true,   // enable cookies to allow the server to access
        // the session
        version: 'v3.3', // use graph api version 3.3
        xfbml: true,   // parse social plugins on this page
      })
      FB.getLoginStatus(function (response) {
        statusChangeCallback(response)
      })
    }

      // Load the SDK asynchronously
      ; (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0]
        if (d.getElementById(id)) return
        js = d.createElement(s)
        js.id = id
        js.src = '//connect.facebook.net/en_US/sdk.js'
        fjs.parentNode.insertBefore(js, fjs)
      }(document, 'script', 'facebook-jssdk'))


    // Here we run a very simple test of the Graph API after login is
    // successful.  See statusChangeCallback() for when this call is made.
    function testAPI() {
      console.log('Welcome!  Fetching your information.... ')
      // FB.api('/me', function (response) {
      //   console.log(`Successful login for: ${response.id}`)
      //   console.log(`Successful login for: ${response.name}`)
      //   console.log(`Successful login for: ${response.toString()}`)
      //   document.getElementById('status').innerHTML = `Thanks for logging in, ${response.name}!`
      // })
      FB.api('/me', 'GET', { "fields": "name,birthday,email,hometown" }, function (response) {
        console.log(`Successful login for: ${response.id}`)
        console.log(`Successful login for: ${response.name}`)
        console.log(`Successful login for: ${response.email}`)
        document.getElementById('status').innerHTML = `Thanks for logging in, ${response.name}!`
      })
      FB.api('/me/?fields=picture', 'GET', {}, function (response) {
        console.log(response.picture.data.url)
        document.getElementById("pic").src = response.picture.data.url
      })

      //FB.api(id, function (response) {
      //   console.log(`Successful login for: ${response.data[0].id}`)
      //})

    }
  </script>



</body>

</html>
<!--
vi:et:ts=2
-->